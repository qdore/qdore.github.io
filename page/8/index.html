<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>第 8 页 | QW&#39;s blog</title>
  <meta name="author" content="Qiang Wei">
  
  <meta name="description" content="Until the end of the world">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="QW&#39;s blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="QW&#39;s blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">QW&#39;s blog</a></h1>
  <h2><a href="/">Until the end of the world</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="/about">about</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-04-14T13:30:27.000Z"><a href="/2014/04/14/文件系统库/">4月 14 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/04/14/文件系统库/">文件系统库</a></h1>
  

    </header>
    <div class="entry">
      
        <html><head><br><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=8" /><title>文件系统库</title><br><style type="text/css" id="wiz_custom_css"><br>body<br>{<br>    font-family: “Microsoft YaHei UI”,”Microsoft YaHei”,SimSun,”Segoe UI”,Tahoma,Helvetica,Sans-Serif,”Microsoft YaHei”, Georgia,Helvetica,Arial,sans-serif,宋体, PMingLiU,serif;<br>    font-size: 10.5pt;<br>    line-height: 1.5;<br>}<br>html, body<br>{<br><br><br>}<br>h1 {<br>    font-size:1.5em;<br>    font-weight:bold;<br>}<br>h2 {<br>    font-size:1.4em;<br>    font-weight:bold;<br>}<br>h3 {<br>    font-size:1.3em;<br>    font-weight:bold;<br>}<br>h4 {<br>    font-size:1.2em;<br>    font-weight:bold;<br>}<br>h5 {<br>    font-size:1.1em;<br>    font-weight:bold;<br>}<br>h6 {<br>    font-size:1.0em;<br>    font-weight:bold;<br>}<br>img {<br>    border:0;<br>    max-width: 100%;<br>}<br>blockquote {<br>    margin-top:0px;<br>    margin-bottom:0px;<br>}<br>table {<br>    border-collapse:collapse;<br>    border:1px solid #bbbbbb;<br>}<br>td {<br>    border-collapse:collapse;<br>    border:1px solid #bbbbbb;<br>}<br></style><br></head><body><font face="Menlo"><span style="font-size: 14px;">class<span style="-evernote-last-insertion-point:true;"> path{<font color="#FF2600">&lt;boost/filesystem.hpp&gt; namespace boost::filesystem &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//需链接libboost_filesystem,system或libboost_all</font></span></span></font><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;path(string&amp; s);</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;path(path&amp; p);&nbsp;</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;path(InputIterator begin,InputIterator end);</font></span></div><div><span style="font-size: 14px;"><font face="Menlo"><br/></font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;path&amp; operator= /= += + &lt;&lt; /(path&amp; path); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // path /= &quot;etc&quot; &nbsp;等价于</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;path&amp; operator= /= += + &lt;&lt; /(string&amp; str); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// path += &quot;/etc&quot;</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;string string(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//获取路径名为字符串</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;value_type<em> c_str();</font></span></div><div><span style="font-family: Menlo; font-size: 14px;">&nbsp; &nbsp; &nbsp;string_type&amp; native();</span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;wstring wstring();</font></span></div><div><span style="font-size: 14px;"><font face="Menlo"><br/></font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;void clear();</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;path&amp; remove_filename();</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;path&amp; replace_extention();</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;void swap(path&amp; path);</font></span></div><div><span style="font-size: 14px;"><font face="Menlo"><br/></font></span></div><div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;path root_name(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//根名称</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;path root_directory(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //根目录</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;path root_path(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//根路径</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;path relative_path(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//相对路径</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;path parent_path(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//上级路径</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;path filename(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //文件名</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;path stem(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //全路径</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;path extension(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//扩展名</font></span></div><div><span style="font-size: 14px;"><font face="Menlo"><br/></font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;bool empty(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//是否空路径</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;bool is_absolute(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//是否是绝对路径</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;bool is_relative(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//是否是相对路径</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;bool has_root_name();<br/>&nbsp; &nbsp; &nbsp;bool has_root_directory();<br/>&nbsp; &nbsp; &nbsp;bool has_root_path();<br/>&nbsp; &nbsp; &nbsp;bool has_relative_path();<br/>&nbsp; &nbsp; &nbsp;bool has_parent_path();&nbsp;<br/>&nbsp; &nbsp; &nbsp;bool has_filename();<br/>&nbsp; &nbsp; &nbsp;bool has_stem();<br/>&nbsp; &nbsp; &nbsp;bool has_extension();<br/></font></span></div></div><div><span style="font-size: 14px;"><font face="Menlo"><br/></font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;iterator begin();</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;iterator end();</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">}</font></span><hr/><span style="font-size: 14px;"><font face="Menlo">class status{</font></span><span style="color: rgb(255, 38, 0); font-family: Menlo; font-size: 14px;">&lt;boost/filesystem.hpp&gt; namespace boost::filesystem &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //需链接libboost_filesystem,</span><span style="color: rgb(255, 38, 0); font-family: Menlo; font-size: 14px;">system或libboost_all</span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;status(path&amp; path，perms per=perms_not_know);</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;file_type type(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//获取文件类型和设置文件类型</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;void type(file_type type);</font></span></div><div><span style="font-size: 14px;"><font face="Menlo"><br/></font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;perms permissions(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //获取文件权限和设置文件权限</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">&nbsp; &nbsp; &nbsp;void permissions(perms&amp; prms);</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">}</font></span></div><div><span style="font-size: 14px;"><font face="Menlo"><br/></font></span></div><div><span style="font-size: 14px;"><font face="Menlo">status_error &nbsp; &nbsp; : &nbsp; &nbsp; 获取文件类型出错</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">file not found &nbsp; : &nbsp; &nbsp; 文件不存在</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">status_unknown &nbsp; : &nbsp; &nbsp; 文件存在但状态未知</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">regular_file &nbsp; &nbsp; : &nbsp; &nbsp; 是一个普通文件</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">directory_file &nbsp; : &nbsp; &nbsp; 是一个目录</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">symlink_file &nbsp; &nbsp; : &nbsp; &nbsp; 是一个链接文件</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">block_file &nbsp; &nbsp; &nbsp; : &nbsp; &nbsp; 是一个块设备文件</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">character_file &nbsp; : &nbsp; &nbsp; 是一个字符设备文件</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">fifo_file &nbsp; &nbsp; &nbsp; &nbsp;: &nbsp; &nbsp; 是一个管道设备文件</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">socket_file &nbsp; &nbsp; &nbsp;: &nbsp; &nbsp; 是一个socket设备文件</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">type_unknown &nbsp; &nbsp; : &nbsp; &nbsp; 文件的类型未知</font></span></div><div><hr/><span style="font-size: 14px;"><font face="Menlo">path initial_path(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//初始路径</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">path current_path(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//当前路径</font></span></div><div><span style="font-size: 14px;"><font face="Menlo">unsigned int file_size(path&amp; p); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//文件大小</font></span></div><div><font face="Menlo"><span style="font-size: 14px;">time_t last_write_time(path&amp; p,time_t=0); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //修改时间或更新修改时间</span></font></div><div><font face="Menlo"><span style="font-size: 14px;"><br/></span></font></div><div><font face="Menlo"><span style="font-size: 14px;">bool create_directory(path&amp; p); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //创建文件夹</span></font></div><div><font face="Menlo"><span style="font-size: 14px;">bool&nbsp;</span></font><span style="font-family: Menlo; font-size: 14px;">create_directorys(path&amp; p); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//递归创建文件夹</span></div><div><span style="font-family: Menlo; font-size: 14px;">bool exists(path&amp; p); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //是否存在</span></div><div><span style="font-family: Menlo; font-size: 14px;">bool rename(path&amp; p1,path&amp; p2); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //重命名</span></div><div><span style="font-family: Menlo; font-size: 14px;">bool copy_file</span><span style="font-family: Menlo; font-size: 14px;">(path&amp; p1,path&amp; p2); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//复制文件</span></div><div><span style="font-family: Menlo; font-size: 14px;">bool remove(path&amp; p); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //删除</span></div><div><span style="font-family: Menlo; font-size: 14px;">bool remove_all(path&amp; p); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //递归删除</span></div><div><font face="Menlo"><span style="font-size: 14px;">bool creat_symlink(</span></font><span style="font-family: Menlo; font-size: 14px;">path&amp; p1,path&amp; p2); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//创建符号链接</span><hr/><span style="font-family: Menlo; font-size: 14px;">directory_iterator end; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //迭代器返回的对象是directory_entry</span></div><div><font face="Menlo"><span style="font-size: 14px;">for(directory_iterator pos(path&amp; p);pos!=end;pos++){ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//它的成员函数有path()和status()分别返回路径和状态</span></font></div><div><font face="Menlo"><span style="font-size: 14px;">&nbsp; &nbsp; &nbsp;cout&lt;&lt;(pos-&gt;path())&lt;&lt;endl;</span></font></div><div><font face="Menlo"><span style="font-size: 14px;">}</span></font></div><div><font face="Menlo"><span style="font-size: 14px;"><br/></span></font></div><div><font face="Menlo"><span style="font-size: 14px;">recursive_directory_iterator end;</span></font></div><div><font face="Menlo"><span style="font-size: 14px;">for(</span></font><span style="font-family: Menlo; font-size: 14px;">recursive_directory_iterator</span><span style="font-family: Menlo; font-size: 14px;">&nbsp;pos(path&amp; p);pos!=end;pos++</span><span style="font-size: 14px; font-family: Menlo;">){</span></div><div><span style="font-size: 14px; font-family: Menlo;">&nbsp; &nbsp; &nbsp;if(</span><span style="font-size: 14px; font-family: Menlo; color: rgb(61, 29, 129);">is_directory</span><span style="font-size: 14px; font-family: Menlo;">(</em>pos)</span><span style="font-family: Menlo; font-size: 14px;">)&nbsp;</span><span style="font-size: 14px; font-family: Menlo;">pos.</span><span style="font-size: 14px; font-family: Menlo; color: rgb(61, 29, 129);">no_push</span><span style="font-size: 14px; font-family: Menlo;">();</span><span style="font-family: Menlo; font-size: 14px;">; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//这句作用使得和上面的广度遍历一样</span></div><div><span style="font-size: 14px; font-family: Menlo;">&nbsp; &nbsp; &nbsp;cout&lt;&lt;pos.level()&lt;&lt;&quot;:&quot;&lt;&lt;(pos-&gt;path)&lt;&lt;endl;</span></div><div><span style="font-size: 14px; font-family: Menlo;">}</span></div><div><span style="font-size: 14px;"><font face="Menlo"><br/></font></span></div><div><span style="font-family: Menlo; font-size: 14px;">class recursive_directory_iterator{</span></div><div><span style="font-family: Menlo; font-size: 14px;">&nbsp; &nbsp; &nbsp;int level(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//返回目录的深度</span></div><div><span style="font-family: Menlo; font-size: 14px;">&nbsp; &nbsp; &nbsp;void pop(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //退出当前目录的遍历</span></div><div><span style="font-family: Menlo; font-size: 14px;">&nbsp; &nbsp; &nbsp;void no_push(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //不遍历本目录</span></div><div><span style="font-family: Menlo; font-size: 14px;">}</span></div></body></html>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-04-14T13:30:27.000Z"><a href="/2014/04/14/时间和日期库/">4月 14 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/04/14/时间和日期库/">时间和日期库</a></h1>
  

    </header>
    <div class="entry">
      
        <p><style type="text/css" id="wiz_custom_css"><br>body<br>{<br>    font-family: “Microsoft YaHei UI”,”Microsoft YaHei”,SimSun,”Segoe UI”,Tahoma,Helvetica,Sans-Serif,”Microsoft YaHei”, Georgia,Helvetica,Arial,sans-serif,宋体, PMingLiU,serif;<br>    font-size: 10.5pt;<br>    line-height: 1.5;<br>}<br>html, body<br>{</p>
<p>}<br>h1 {<br>    font-size:1.5em;<br>    font-weight:bold;<br>}<br>h2 {<br>    font-size:1.4em;<br>    font-weight:bold;<br>}<br>h3 {<br>    font-size:1.3em;<br>    font-weight:bold;<br>}<br>h4 {<br>    font-size:1.2em;<br>    font-weight:bold;<br>}<br>h5 {<br>    font-size:1.1em;<br>    font-weight:bold;<br>}<br>h6 {<br>    font-size:1.0em;<br>    font-weight:bold;<br>}<br>img {<br>    border:0;<br>    max-width: 100%;<br>}<br>blockquote {<br>    margin-top:0px;<br>    margin-bottom:0px;<br>}<br>table {<br>    border-collapse:collapse;<br>    border:1px solid #bbbbbb;<br>}<br>td {<br>    border-collapse:collapse;<br>    border:1px solid #bbbbbb;<br>}<br></style></p>
<HTML><HEAD><br><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=8" /><TITLE>时间和日期库</TITLE><br><!--defaultCSS--><br><style type="text/css"><br>img{<br>    border:0px;<br>    max-width:90%;<br>}<br></style><br><BODY><br><div><br><div><span style="font-size: 14px;">class timer{<span style="color: rgb(255, 39, 0);">&lt;boost/timer.hpp&gt; namespace boost;</span></span></div><br><div><span style="font-size: 14px;">     void restart();                                                                                                   //计时重新开始</span></div><br><div><span style="font-size: 14px;">     double elapser<em>max();                                                                                    //可度量的最大时间</span></div><br><div><span style="font-size: 14px;">     double elapser_min();                                                                                     //可度量的最小时间</span></div><br><div><span style="font-size: 14px;">     double elapsed();                                                                                            //从对象生成到流逝的时间</span></div><br><div><span style="font-size: 14px;">};</span><br><hr/></div><br><div><span style="font-size: 14px;">class date{</span><span style="color: rgb(255, 39, 0); font-size: 14px;">&lt;boost/date_time.hpp&gt; namespace boost:gregorian;</span><span style="font-size: 14px;">                        //</span><span style="font-size: 14px;">需加库libboost_date_time-mt.a或libboost_date_time-mt.so</span><span style="font-size: 14px;">                                                                                       </span><br/></div><br></div><br><div><span style="font-size: 14px;">     date(year_type year,month_type month,day_type day);                                //构造函数</span></div><br><div><span style="font-size: 14px;">     date(const date t);</span></div><br><div><span style="font-size: 14px;">     date(ymd_type &amp;);                                                                                          //date d(neg_infin / pos_infin / not_a_date_time / max_date_time / min_date_time);</span></div><br><div><span style="font-size: 14px;">     </span></div><br><div><span style="font-size: 14px;">     year_type year();                                                                                            //返回年月日</span></div><br><div><span style="font-size: 14px;">     month_type month();</span></div><br><div><span style="font-size: 14px;">     day_type day();</span></div><br><div><span style="font-size: 14px;">     day_of_week_type day_of_week();                                                                //返回day of 年月星期</span></div><br><div><span style="font-size: 14px;">     day_of_month_type day_of</em>();month</span></div><br><div><span style="font-size: 14px;">     day_of_year_type day_of_year();</span></div><br><div><span style="font-size: 14px;">                                                                               <br/></span></div><br><div><span style="font-size: 14px;">     bool is_special();                                                                                            //是否是任意一个特殊日期</span></div><br><div><span style="font-size: 14px;">     bool is_not_a_date();</span></div><br><div><span style="font-size: 14px;">     bool is_infinity();</span></div><br><div><span style="font-size: 14px;">     bool is_pos_infinity();</span></div><br><div><span style="font-size: 14px;">     bool is_neg_infinity();</span></div><br><div><span style="font-size: 14px;">     </span></div><br><div><span style="font-size: 14px;">     date_duration/bool operator+(const date_type &amp;);                                         //重载了 + - <em> / &gt;&gt; &lt;&lt; &lt; &gt; ==</span></div><br><div><span style="font-size: 14px;">          …</span></div><br><div><span style="font-size: 14px;">};</span></div><br><div><span style="font-size: 14px;">date day_clock::local_day();                                                                               //取得当前日期</span></div><br><div><span style="font-size: 14px;"><br/></span></div><br><div><span style="font-size: 14px;">string to_simple_string(date d);                                                                          //返回<b style="font-family: Menlo;">2014-Jan-30 </b></span></div><br><div><span style="font-size: 14px;">string to_iso_string(date d);                                                                                //返回<b style="font-family: Menlo;">20140130</b></span></div><br><div><span style="font-size: 14px;">string to_iso_extended_string(date d);                                                               //返回<b style="font-family: Menlo;">2014-01-30</b></span></div><br><div><b style="font-family: Menlo; font-size: 14px;"><br/></b></div><br><div><span style="font-size: 14px;">tm to_tm(date d);                                                                                               //date与tm结构的互换</span></div><br><div><span style="font-size: 14px;">date date_from_tm(tm t);                              </span></div><br><div><span style="font-size: 14px;"><br/></span></div><br><div><span style="font-size: 14px;">日期长度类：days/weeks/months(date_duration);</span></div><br><div><span style="font-size: 14px;">日期迭代器：day_iterator/week_iterator/month_iterator</span></div><br><div><br><hr/><br><span style="font-size: 14px;">class date_period/time_period{</span><span style="color: rgb(255, 39, 0); font-size: 14px;">&lt;boost/date_time.hpp&gt; namespace boost:gregorian;</span></div><br><div><span style="font-size: 14px;">     date_period(date d1,date d2);                                                                      //构造函数</span></div><br><div><span style="font-size: 14px;">     date_period(date d,days/weeks/months t);</span></div><br><div><span style="font-size: 14px;"><br/></span></div><br><div><span style="font-size: 14px;">     date begin();                                                                                                 //返回日期区间的开始端点</span></div><br><div><span style="font-size: 14px;">     date last();                                                                                                    //返回日期区间的结束端点</span></div><br><div><span style="font-size: 14px;">     date end();                                                                                                   //返回日期区间的结束端点+1</span></div><br><div><span style="font-size: 14px;">     days length();                                                                                               //返回日期区间的长度</span></div><br><div><span style="font-size: 14px;">     bool is_null();</span></div><br><div><span style="font-size: 14px;"><br/></span></div><br><div><span style="font-size: 14px;">     void shift(days d);                                                                                        //平移</span></div><br><div><span style="font-size: 14px;">     void expand(days d);                                                                                   //扩展</span></div><br><div><span style="font-size: 14px;"><br/></span></div><br><div><span style="font-size: 14px;">     bool contains(date&amp; d);                                                                               //是否包含</span></div><br><div><span style="font-size: 14px;">     bool contains(date_period&amp; d);     </span></div><br><div><span style="font-size: 14px;">     bool intersects(date_period&amp; d);                                                                 //是否存在交集</span></div><br><div><span style="font-size: 14px;">     bool is_adjacent(date_period&amp; d);                                                              //两个时间区间是否相邻</span></div><br><div><span style="font-size: 14px;">     bool is_before(date&amp; d);                                                                             //是否在区间之前</span></div><br><div><span style="font-size: 14px;">     bool is_after(date&amp; d);                                                                                //是否在区间之后</span></div><br><div><span style="font-size: 14px;">     </span></div><br><div><span style="font-size: 14px;">     period intersection(date_period&amp; d);                                                          //返回两个日期区间的交集</span></div><br><div><span style="font-size: 14px;">     period merge(date_period&amp; d);                                                                  //返回两个日期区间的并集(必须相邻或相交)</span></div><br><div><span style="font-size: 14px;">     period span(date_period&amp; d);                                                                     //合并两个日期区间及两者间的间隔</span></div><br><span style="font-size: 14px;"><br/></span><br><div><span style="font-size: 14px;">     bool operator ==/&lt;(date_period&amp; d);                                                           //重载<br/></span></div><br><div><span style="font-size: 14px;">};</span><br><hr/><br><span style="font-size: 14px;">class time_duration{<font color="#FF2900">&lt;</font><span style="font-family: Menlo;"><font color="#FF2900">b</font></span><span style="color: rgb(209, 47, 27); font-family: Menlo;">oost/date_time/posix_time/posix_time.hpp&gt; </span><span style="color: rgb(255, 39, 0);">namespace boost:posix_time;</span>                                                                                         </span></div><br><div><span style="font-size: 14px;">     time_duration();                                                                                           //构造函数</span></div><br><div><span style="font-size: 14px;">     time_duration(hour_type hour,month_type month,day_type day);</span></div><br><div><span style="font-size: 14px;">     time_duration(special_values);</span></div><br><div><span style="font-size: 14px;"><br/></span></div><br><div><span style="font-size: 14px;">     hour_type hour();                                                                                         //返回时分秒总时间</span></div><br><div><span style="font-size: 14px;">     min_type minutes();</span></div><br><div><span style="font-size: 14px;">     sec_type seconds();</span></div><br><div><span style="font-size: 14px;">     sec_type total_seconds();</span></div><br><div><span style="font-size: 14px;">     tick_type total_milliseconds/total_nanoseconds/microseconds();</span></div><br><div><span style="font-size: 14px;">     </span></div><br><div><span style="font-size: 14px;">     duration_type invert_sign();                                                                         //转换正负号</span></div><br><div><span style="font-size: 14px;">     </span></div><br><div><span style="font-size: 14px;">     bool is_negative();                                                                                        //是否为负？</span></div><br><div><span style="font-size: 14px;">     bool is_special();</span></div><br><div><span style="font-size: 14px;">     bool is_not_a_date_time();</span></div><br><div><span style="font-size: 14px;">     bool is_pos_infinity();</span></div><br><div><span style="font-size: 14px;">     bool is_neg_infinity();</span></div><br><div><span style="font-size: 14px;"><br/></span></div><br><div><span style="font-size: 14px;">     date_duration/bool operator+(const date_type &amp;);                                       <span style="-evernote-last-insertion-point:true;"/>//重载了 + - </em> / &gt;&gt; &lt;&lt; &lt; &gt; ==</span></div><br><div><span style="font-size: 14px;">          …</span><span style="font-size: 14px;"><br/></span></div><br><div><span style="font-size: 14px;">}</span></div><br><div><span style="font-size: 14px;">string to_simple_string(time_duration d);                                                          //返回<b style="font-family: Menlo;">20:07:21</b><b style="font-family: Menlo;"> </b></span></div><br><div><span style="font-size: 14px;">string to_iso_string(time_duration d);                                                                //返回<b style="font-family: Menlo;">200645</b><b style="font-family: Menlo;"> </b></span></div><br><div><br><hr/><br><span style="font-size: 14px;">class ptime{<font color="#FF2900">&lt;</font><span style="font-family: Menlo;"><font color="#FF2900">b</font></span><span style="color: rgb(209, 47, 27); font-family: Menlo;">oost/date_time/posix_time/posix_time.hpp&gt; </span><span style="color: rgb(255, 39, 0);">namespace boost:gregorian;</span><span style="color: rgb(255, 39, 0);">namespace boost:posix_time;</span><span style="color: rgb(255, 39, 0);"> </span><span style="color: rgb(255, 39, 0);"> </span><span style="color: rgb(255, 39, 0);"> </span></span></div><br><div><span style="font-size: 14px;">     ptime(date&amp; date,time_duration&amp; time);                                                       //构造函数</span></div><br><div><span style="font-size: 14px;">     ptime(special_values);</span></div><br><div><span style="font-size: 14px;"><br/></span></div><br><div><span style="font-size: 14px;">     date_type date();                                                                                           //返回日期和时间</span></div><br><div><span style="font-size: 14px;">     time_duration_type time_of_day();</span></div><br><div><span style="font-size: 14px;"><br/></span></div><br><div><span style="font-size: 14px;">     bool is_not_a_date_time();                                                                           </span></div><br><div><span style="font-size: 14px;">     bool is_pos_infinity();</span></div><br><div><span style="font-size: 14px;">     bool is_neg_infinity();<br/></span></div><br><div><span style="font-size: 14px;">     bool is_special();                                                                                            //是否是任意一个特殊日期</span></div><br><div><span style="font-size: 14px;">     bool is_infinity();<br/></span></div><br><div><span style="font-size: 14px;"><br/></span></div><br><div><span style="font-size: 14px;">     date_duration/bool operator+(const date_type &amp;);                                         //重载了 + - * / &gt;&gt; &lt;&lt; &lt; &gt; ==</span></div><br><div><span style="font-size: 14px;">          …</span><span style="font-size: 14px;"><br/></span></div><br><div><span style="font-size: 14px;">}</span></div><br><div><span style="font-size: 14px;">ptime second_clock::local_time();                                                                       //返回当前日期秒精度，微秒精度</span></div><br><div><span style="font-size: 14px;">ptime micro_clock::universal_time();</span></div><br><div><span style="font-size: 14px;"><br/></span></div><br><div><span style="font-size: 14px;">string to_simple_string(</span><span style="font-size: 14px;">ptime</span><span style="font-size: 14px;"> d);                                                                         //返回</span><b style="font-size: 14px; font-family: Menlo;">2014-Jan-30 20:08:04</b><b style="font-size: 14px; font-family: Menlo;"> </b></div><br><div><span style="font-size: 14px;">string to_iso_string(</span><span style="font-size: 14px;">ptime</span><span style="font-size: 14px;"> d);                                                                               //返回</span><b style="font-size: 14px; font-family: Menlo;">20140130T200821</b><span style="font-size: 14px;"> </span></div><br><div><span style="font-size: 14px;">string to_iso_extended_string(</span><span style="font-size: 14px;">ptime</span><span style="font-size: 14px;"> d);                                                              //返回</span><b style="font-size: 14px; font-family: Menlo;">2014-01-30T20:08:37</b><span style="font-size: 14px;"> </span></div><br><div><span style="font-size: 14px;">tm to_tm(ptime t);                                                                                                //转换为tm结构</span></div><br><div><span style="font-size: 14px;">ptime from_time_t(time_t&amp; t);                                                                              //time_t转换为ptime</span></div><br><div><span style="font-size: 14px;">ptime ptime_from_tm(tm&amp; t);                                                                               //tm转换为ptime</span></div><br><div><span style="font-size: 14px;"><br/></span></div><br><div><span style="font-size: 14px;">time_iterator(ptime t,minutes n);                                                                          //时间迭代器</span><br><hr/><br>时间库chrono C++11</div><br><pre style="padding: 0px; border: 0px none white; background-color: rgb(249, 249, 249); line-height: 1.2em; border-top-left-radius: 5px; border-top-right-radius: 5px; border-bottom-right-radius: 5px; border-bottom-left-radius: 5px; overflow: auto; font-size: 1em; background-image: none; vertical-align: top; text-align: left;"><br><span style="color: rgb(51, 153, 0);">#include &lt;iostream&gt;</span><br><span style="color: rgb(51, 153, 0);">#include &lt;iomanip&gt;</span><br><span style="color: rgb(51, 153, 0);">#include &lt;ctime&gt;</span><br><span style="color: rgb(51, 153, 0);">#include &lt;chrono&gt;</span><br><br><span style="color: rgb(0, 0, 255);">int</span> main<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><br><span style="color: rgb(0, 128, 0);">{</span><br>    std<span style="color: rgb(0, 128, 128);">::</span>chrono<span style="color: rgb(0, 128, 128);">::</span>time_point<span style="color: rgb(0, 0, 128);">&lt;</span><a href="http://zh.cppreference.com/w/cpp/chrono/system_clock" style="text-decoration: none; color: rgb(0, 48, 128); background-image: none; background-position: initial initial; background-repeat: initial initial;" target="_blank">std::chrono<span style="color: rgb(0, 128, 128);">::</span>system_clock</a><span style="color: rgb(0, 0, 128);">&gt;</span> now<span style="color: rgb(0, 128, 128);">;     //本地时间</span><br>    now <span style="color: rgb(0, 0, 128);">=</span> std<span style="color: rgb(0, 128, 128);">::</span>chrono<span style="color: rgb(0, 128, 128);">::</span>system_clock<span style="color: rgb(0, 128, 128);">::</span>now<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span><br></pre><br><pre style="padding: 0px; border: 0px none white; background-color: rgb(249, 249, 249); line-height: 1.2em; border-top-left-radius: 5px; border-top-right-radius: 5px; border-bottom-right-radius: 5px; border-bottom-left-radius: 5px; overflow: auto; font-size: 1em; background-image: none; vertical-align: top; text-align: left;"><br><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">     auto</span><span style="font-size: 14px; font-family: Menlo;"> cl=</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">hours</span><span style="font-size: 14px; font-family: Menlo;">(</span><span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">3</span><span style="font-size: 14px; font-family: Menlo;">)+</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">minutes</span><span style="font-size: 14px; font-family: Menlo;">(</span><span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">2</span><span style="font-size: 14px; font-family: Menlo;">);                              //时间间隔</span><span style="color: rgb(0, 128, 128);"><br/></span><br></pre><br><pre style="padding: 0px; border: 0px none white; background-color: rgb(249, 249, 249); line-height: 1.2em; border-top-left-radius: 5px; border-top-right-radius: 5px; border-bottom-right-radius: 5px; border-bottom-left-radius: 5px; overflow: auto; font-size: 1em; background-image: none; vertical-align: top; text-align: left;"><br><span style="color: rgb(0, 128, 0); font-size: 1em; line-height: 1.2em;">}</span><br></pre><br><ul style="line-height: 1.5em; list-style-type: square; padding: 0px; list-style-image: url(data:image/png; color: rgb(0, 0, 0); font-family: DejaVuSans, 'DejaVu Sans', arial, sans-serif; font-size: 12.727272033691406px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><br><li style=" line-height: 1.1em; padding-bottom: 0.4em; list-style: none none; font-size: 1em;"><a href="http://zh.cppreference.com/w/cpp/chrono/duration" title="cpp/chrono/duration" style="text-decoration: none; color: rgb(11, 0, 128); background-image: none; font-size: 13.63636302947998px; background-position: initial initial; background-repeat: initial initial;" target="_blank">std::chrono::hours</a></li><br><li style=" line-height: 1.1em; padding-bottom: 0.4em; list-style: none none; font-size: 1em;"><a href="http://zh.cppreference.com/w/cpp/chrono/duration" title="cpp/chrono/duration" style="text-decoration: none; color: rgb(11, 0, 128); background-image: none; font-size: 13.63636302947998px; background-position: initial initial; background-repeat: initial initial;" target="_blank">std::chrono::minutes</a></li><br><li style=" line-height: 1.1em; padding-bottom: 0.4em; list-style: none none; font-size: 1em;"><a href="http://zh.cppreference.com/w/cpp/chrono/duration" title="cpp/chrono/duration" style="text-decoration: none; color: rgb(11, 0, 128); background-image: none; font-size: 13.63636302947998px; background-position: initial initial; background-repeat: initial initial;" target="_blank">std::chrono::seconds</a></li><br><li style=" line-height: 1.1em; padding-bottom: 0.4em; list-style: none none; font-size: 1em;"><a href="http://zh.cppreference.com/w/cpp/chrono/duration" title="cpp/chrono/duration" style="text-decoration: none; color: rgb(11, 0, 128); background-image: none; font-size: 13.63636302947998px; background-position: initial initial; background-repeat: initial initial;" target="_blank">std::chrono::duration</a></li><br><li style=" line-height: 1.1em; padding-bottom: 0.4em; list-style: none none; font-size: 1em;"><a href="http://zh.cppreference.com/w/cpp/chrono/time_point" title="cpp/chrono/time point" style="text-decoration: none; color: rgb(11, 0, 128); background-image: none; font-size: 13.63636302947998px; background-position: initial initial; background-repeat: initial initial;" target="_blank">std::chrono::time_point</a></li><br><li style=" line-height: 1.1em; padding-bottom: 0.4em; list-style: none none; font-size: 1em;"><a href="http://zh.cppreference.com/w/cpp/chrono/duration" title="cpp/chrono/duration" style="text-decoration: none; color: rgb(11, 0, 128); background-image: none; font-size: 13.63636302947998px; background-position: initial initial; background-repeat: initial initial;" target="_blank">std::chrono::nanoseconds</a></li><br><li style=" line-height: 1.1em; padding-bottom: 0.4em; list-style: none none; font-size: 1em;"><a href="http://zh.cppreference.com/w/cpp/chrono/duration" title="cpp/chrono/duration" style="text-decoration: none; color: rgb(11, 0, 128); background-image: none; font-size: 13.63636302947998px; background-position: initial initial; background-repeat: initial initial;" target="_blank">std::chrono::microseconds</a></li><br><li style=" line-height: 1.1em; padding-bottom: 0.4em; list-style: none none; font-size: 1em;"><a href="http://zh.cppreference.com/w/cpp/chrono/duration" title="cpp/chrono/duration" style="text-decoration: none; color: rgb(11, 0, 128); background-image: none; font-size: 13.63636302947998px; background-position: initial initial; background-repeat: initial initial;" target="_blank">std::chrono::milliseconds</a></li><br><li style=" line-height: 1.1em; padding-bottom: 0.4em; list-style: none none; font-size: 1em;"><a href="http://zh.cppreference.com/w/cpp/chrono/steady_clock" title="cpp/chrono/steady clock" style="text-decoration: none; color: rgb(11, 0, 128); background-image: none; font-size: 13.63636302947998px; background-position: initial initial; background-repeat: initial initial;" target="_blank">std::chrono::steady_clock</a></li><br><li style=" line-height: 1.1em; padding-bottom: 0.4em; list-style: none none; font-size: 1em;"><a href="http://zh.cppreference.com/w/cpp/chrono/system_clock" title="cpp/chrono/system clock" style="text-decoration: none; color: rgb(11, 0, 128); background-image: none; font-size: 13.63636302947998px; background-position: initial initial; background-repeat: initial initial;" target="_blank">std::chrono::system_clock</a></li><br></ul><br><pre style="padding: 0px; border: 0px none white; background-color: rgb(249, 249, 249); line-height: 1.2em; border-top-left-radius: 5px; border-top-right-radius: 5px; border-bottom-right-radius: 5px; border-bottom-left-radius: 5px; overflow: auto; font-size: 1em; background-image: none; vertical-align: top; text-align: left;"><br></pre><br><pre style="font-size: 1em; padding: 0px; border: 0px none white; line-height: 1.2em; border-top-left-radius: 5px; border-top-right-radius: 5px; border-bottom-right-radius: 5px; border-bottom-left-radius: 5px; overflow: auto; background-image: none; vertical-align: top;"><br><span style="font-size: 1em; line-height: 1.2em;">system_clock</span><span style="font-size: 1em; line-height: 1.2em; color: rgb(0, 128, 128);">::</span><span style="font-size: 1em; line-height: 1.2em;">to_time_t</span><span style="color: rgb(0, 128, 0); font-size: 1em; line-height: 1.2em;"><br/></span><br></pre><br><pre style="font-size: 1em; padding: 0px; border: 0px none white; line-height: 1.2em; border-top-left-radius: 5px; border-top-right-radius: 5px; border-bottom-right-radius: 5px; border-bottom-left-radius: 5px; overflow: auto; background-image: none; vertical-align: top;"><br><span style="font-size: 1em; line-height: 1.2em;">system_clock</span><span style="font-size: 1em; line-height: 1.2em; color: rgb(0, 128, 128);">::</span><span style="font-size: 1em; line-height: 1.2em;">from_time_t</span><span style="color: rgb(0, 128, 0); font-size: 1em; line-height: 1.2em;"><br/></span><br></pre><br><div><span style="font-size: 1em; line-height: 1.2em;"><br/></span></div><br></BODY><br></HTML>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-04-14T13:30:27.000Z"><a href="/2014/04/14/线程和互斥量 C++11支持/">4月 14 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/04/14/线程和互斥量 C++11支持/">线程和互斥量 C++11支持</a></h1>
  

    </header>
    <div class="entry">
      
        <p><style type="text/css" id="wiz_custom_css"><br>body<br>{<br>    font-family: “Microsoft YaHei UI”,”Microsoft YaHei”,SimSun,”Segoe UI”,Tahoma,Helvetica,Sans-Serif,”Microsoft YaHei”, Georgia,Helvetica,Arial,sans-serif,宋体, PMingLiU,serif;<br>    font-size: 10.5pt;<br>    line-height: 1.5;<br>}<br>html, body<br>{</p>
<p>}<br>h1 {<br>    font-size:1.5em;<br>    font-weight:bold;<br>}<br>h2 {<br>    font-size:1.4em;<br>    font-weight:bold;<br>}<br>h3 {<br>    font-size:1.3em;<br>    font-weight:bold;<br>}<br>h4 {<br>    font-size:1.2em;<br>    font-weight:bold;<br>}<br>h5 {<br>    font-size:1.1em;<br>    font-weight:bold;<br>}<br>h6 {<br>    font-size:1.0em;<br>    font-weight:bold;<br>}<br>img {<br>    border:0;<br>    max-width: 100%;<br>}<br>blockquote {<br>    margin-top:0px;<br>    margin-bottom:0px;<br>}<br>table {<br>    border-collapse:collapse;<br>    border:1px solid #bbbbbb;<br>}<br>td {<br>    border-collapse:collapse;<br>    border:1px solid #bbbbbb;<br>}<br></style></p>
<HTML><HEAD><br><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=8" /><TITLE>线程和互斥量 C++11支持</TITLE><br><!--defaultCSS--><br><style type="text/css"><br>img{<br>    border:0px;<br>    max-width:90%;<br>}<br></style><br><BODY><br><div><font face="Menlo" style="font-size: 14px;">class mutex{</font><span style="color: rgb(209, 47, 27); font-family: Menlo; font-size: 14px;">&lt;boost/thread/thread.hpp&gt; namespace boost;             //C++11支持</span></div><br><div><font face="Menlo"><span style="font-size: 14px;">     void lock();                                                  //锁定</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     void unlock();                                                //解锁,阻塞函数</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     bool try_lock();                                              //尝试锁定，成功返回1</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     bool try_lock_for(chrono::duration&amp; time);                    //限时锁定，相对时间</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     bool try_lock_until(chrono::time_point&amp; t);                   //限时锁定，绝对时间</span></font></div><br><span style="font-size: 14px; font-family: Menlo;">}</span><br><div><font face="Menlo"><span style="font-size: 14px;">mutex::scoped_lock lock(mutex);可以在析构时自动解锁，避免try-catch块</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;"><br/></span></font><br><div><font face="Menlo" style="font-size: 14px;">互斥量种类：</font><br><div><font face="Menlo" style="font-size: 14px;">mutex                          : 独占式的互斥量</font></div><br><div><span style="font-size: 14px;"><font face="Menlo">timed_mutex                    : </font><font face="Menlo">带超时锁定</font><span style="font-family: Menlo;">独占式的互斥量</span></span></div><br><div><font face="Menlo" style="font-size: 14px;">recursive_mutex                : 递归式的互斥量,允许同一个线程多次lock</font></div><br><div><span style="font-size: 14px;"><font face="Menlo">recursive_timed_mutex          : </font><font face="Menlo">带超时锁定</font><span style="font-family: Menlo;">递归式的互斥量</span></span></div><br><div><font face="Menlo" style="font-size: 14px;">shared_mutex                   : 共享互斥量</font><br><hr/><br><font face="Menlo" style="font-size: 14px;">class thread{</font><span style="color: rgb(209, 47, 27); font-family: Menlo; font-size: 14px;">&lt;boost/thread/thread.hpp&gt; namespace boost;             //</span><span style="color: rgb(209, 47, 27); font-family: Menlo; font-size: 14px;">C++11支持#include &lt;thread&gt;</span></div><br></div><br></div><br><div><font face="Menlo"><span style="font-size: 14px;">     thread(F f,A1 a1,A2 a2,…);                                     //构造函数和转移</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     thread(thread&amp; thread);</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     thread&amp; operator=(thread th);</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     </span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     bool joinable();                                               //是否是一个可执行的线程体</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     void join();                                                   //一直阻塞等待，知道线程结束</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;"><br/></span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     bool try_join_for(</span></font><span style="font-family: Menlo; font-size: 14px;">chrono::duration&amp; time)</span><span style="font-size: 14px; font-family: Menlo;">;                     //限时阻塞等待</span></div><br><div><font face="Menlo"><span style="font-size: 14px;">     bool try_join_until(</span></font><span style="font-family: Menlo; font-size: 14px;">chrono::time_point&amp; t)</span><span style="font-size: 14px; font-family: Menlo;">;</span></div><br><div><font face="Menlo"><span style="font-size: 14px;"><br/></span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     void detach();                                                 //分离线程</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;"><br/></span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     void interrupt();                                              //终端线程</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;"><br/></span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     id get_id();                                                   //获得线程ID</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     native_handle_type native_handle();                            //获得线程的handle</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;"><br/></span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     static unsigned hardware_concurrency();                        //获得并发数</span></font></div><br><div><font face="Menlo" style="font-size: 14px;"><br/></font></div><br><div><font face="Menlo" style="font-size: 14px;">}</font><br><hr/></div><br><div><font face="Menlo" style="font-size: 14px;">class condition_variable_any{                                       <font color="#FF2600">//条件变量来保证线程之间有序执行</font></font></div><br><div><font face="Menlo" style="font-size: 14px;">     void notify_one();                                             //通知一个等待中的线程</font></div><br><div><font face="Menlo" style="font-size: 14px;"><br/></font></div><br><div><font face="Menlo" style="font-size: 14px;">     void wait(mutex&amp; mu);                                          //必须是lock状态的互斥量被锁定</font></div><br><div><font face="Menlo" style="font-size: 14px;">     </font></div><br><div><span style="font-family: Menlo; font-size: 14px;">     void notify_all();</span><font face="Menlo" style="font-size: 14px;"><br/></font></div><br><div><font face="Menlo" style="font-size: 14px;">     cv_status wait_for(mutex&amp; mu,</font><span style="font-family: Menlo; font-size: 14px;">chrono::duration&amp; time);</span></div><br><div><font face="Menlo" style="font-size: 14px;">     </font><span style="font-family: Menlo; font-size: 14px;">cv_status wait_until(mutex&amp; mu,</span><span style="font-family: Menlo; font-size: 14px;">chrono::time_point&amp; t);</span><span style="font-family: Menlo; font-size: 14px;"> </span></div><br><div><span style="font-family: Menlo; font-size: 14px;">     void wait(mutex&amp; mu,predicate_type predicate);                 //条件等待</span></div><br><div><font face="Menlo" style="font-size: 14px;">}</font><br><hr/><br><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">使用future对象取得线程返回值：</span></div><br><div><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">int</span> <span style="font-size: 14px; font-family: Menlo;">fab</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">（</span><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">int</span> <span style="font-size: 14px; font-family: Menlo;">n</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">）</span> <span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">//</span> <span style="font-size: 14px; font-family: 'Heiti SC Light'; color: rgb(0, 132, 0);">递归策画斐波那契数列</span><span style="font-size: 14px; font-family: Menlo;"><br/><br>{<br/><br>   </span> <span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">if</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">（</span><span style="font-size: 14px; font-family: Menlo;">n ==</span> <span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">0</span> <span style="font-size: 14px; font-family: Menlo;">|| n ==</span> <span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">1</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">）</span> <span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">return</span> <span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">1</span><span style="font-size: 14px; font-family: Menlo;">;<br/><br>       </span> <span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">return</span> <span style="font-size: 14px; font-family: Menlo;">fab</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">（</span><span style="font-size: 14px; font-family: Menlo;">n -</span> <span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">1</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">）</span> <span style="font-size: 14px; font-family: Menlo;">+ fab</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">（</span><span style="font-size: 14px; font-family: Menlo;">n -</span> <span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">2</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">）</span><span style="font-size: 14px; font-family: Menlo;">;<br/><br>}<br/></span><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">int</span> <span style="font-size: 14px; font-family: Menlo;">main</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">（）</span><span style="font-size: 14px; font-family: Menlo;"><br/><br>{<br/><br>    packaged_task&lt;</span><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">int</span><span style="font-size: 14px; font-family: Menlo;">&gt; pt</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">（</span><span style="font-size: 14px; font-family: Menlo;">bind</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">（</span><span style="font-size: 14px; font-family: Menlo;">fab</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">，</span> <span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">10</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">））</span><span style="font-size: 14px; font-family: Menlo;">;</span> <span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">//</span> <span style="font-size: 14px; font-family: 'Heiti SC Light'; color: rgb(0, 132, 0);">声明</span><span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">packaged_task</span><span style="font-size: 14px; font-family: 'Heiti SC Light'; color: rgb(0, 132, 0);">对象，用模板参数指明返回值的类型，</span><span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">packaged_task</span><span style="font-size: 14px; font-family: 'Heiti SC Light'; color: rgb(0, 132, 0);">只接管无参函数，是以须要应用</span><span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">bind</span><span style="font-size: 14px; font-family: Menlo;"><br/><br>    unique_future&lt;</span><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">int</span><span style="font-size: 14px; font-family: Menlo;">&gt; uf = pt.get_future</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">（）</span><span style="font-size: 14px; font-family: Menlo;">;</span> <span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">//</span> <span style="font-size: 14px; font-family: 'Heiti SC Light'; color: rgb(0, 132, 0);">声明</span><span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">unique_future</span><span style="font-size: 14px; font-family: 'Heiti SC Light'; color: rgb(0, 132, 0);">对象，接管</span><span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">packaged_task</span><span style="font-size: 14px; font-family: 'Heiti SC Light'; color: rgb(0, 132, 0);">的</span><span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">future</span><span style="font-size: 14px; font-family: 'Heiti SC Light'; color: rgb(0, 132, 0);">值，同样要用模板参数指明返回值类型</span><span style="font-size: 14px; font-family: Menlo;"><br/><br>    thread</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">（</span><span style="font-size: 14px; font-family: Menlo;">boost::move</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">（</span><span style="font-size: 14px; font-family: Menlo;">pt</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">））</span><span style="font-size: 14px; font-family: Menlo;">;                </span><span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">//</span> <span style="font-size: 14px; font-family: 'Heiti SC Light'; color: rgb(0, 132, 0);">启动线程策画，必须应用</span><span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">boost::move</span><span style="font-size: 14px; font-family: 'Heiti SC Light'; color: rgb(0, 132, 0);">（）来转移</span><span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">packaged_task</span><span style="font-size: 14px; font-family: 'Heiti SC Light'; color: rgb(0, 132, 0);">对象，因为</span><span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">packaged_task</span><span style="font-size: 14px; font-family: 'Heiti SC Light'; color: rgb(0, 132, 0);">是不成拷贝的</span><span style="font-size: 14px; font-family: Menlo;"><br/><br>    uf.wait</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">（）</span><span style="font-size: 14px; font-family: Menlo;">;</span> <span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">// unique_future</span><span style="font-size: 14px; font-family: 'Heiti SC Light'; color: rgb(0, 132, 0);">守候策画成果</span><span style="font-size: 14px; font-family: Menlo;"><br/><br>    assert</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">（</span><span style="font-size: 14px; font-family: Menlo;">uf.is_ready</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">（）</span> <span style="font-size: 14px; font-family: Menlo;">&amp;&amp; uf.has_value</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">（））</span><span style="font-size: 14px; font-family: Menlo;">;<br/><br>    cout &lt;&lt; uf.get</span><span style="font-size: 14px; font-family: 'Heiti SC Light';">（）</span> <span style="font-size: 14px; font-family: Menlo;">&lt;&lt; endl;</span> <span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">//</span> <span style="font-size: 14px; font-family: 'Heiti SC Light'; color: rgb(0, 132, 0);">输出策画成果</span><span style="font-size: 14px; font-family: Menlo; color: rgb(0, 132, 0);">89</span><span style="font-size: 14px; font-family: Menlo;"><br/><br>}</span></div><br><div><br><hr/></div><br><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">int</span> <span style="font-size: 14px; font-family: Menlo;">main(){<br/><br>   </span> <span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">typedef</span> <span style="font-size: 14px; font-family: Menlo;">packaged_task&lt;</span><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">int</span><span style="font-size: 14px; font-family: Menlo;">&gt; pti_t;<br/><br>   </span> <span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">typedef</span> <span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">unique_future</span><span style="font-size: 14px; font-family: Menlo;">&lt;</span><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">int</span><span style="font-size: 14px; font-family: Menlo;">&gt; fi_t;<br/><br>    boost::array&lt;pti_t,</span><span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">5</span><span style="font-size: 14px; font-family: Menlo;">&gt; ap;<br/><br>    boost::array&lt;fi_t,</span><span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">5</span><span style="font-size: 14px; font-family: Menlo;">&gt; au;<br/><br>   </span> <span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">for</span><span style="font-size: 14px; font-family: Menlo;">(</span><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">int</span> <span style="font-size: 14px; font-family: Menlo;">i=</span><span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">0</span><span style="font-size: 14px; font-family: Menlo;">;i&lt;</span><span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">5</span><span style="font-size: 14px; font-family: Menlo;">;++i){<br/><br>        ap[i]=pti_t(boost::bind(fab,i+</span><span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">10</span><span style="font-size: 14px; font-family: Menlo;">));<br/><br>        au[i]=ap[i].get_future();<br/><br>        thread(boost::move(ap[i]));<br/><br>    }<br/><br>    wait_for_all(au.begin(),au.end());               :</span>      <span style="font-size: 14px; font-family: Menlo;">wait_for_any(au[</span><span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">1</span><span style="font-size: 14px; font-family: Menlo;">],au[</span><span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">2</span><span style="font-size: 14px; font-family: Menlo;">]);</span><span style="font-size: 14px; font-family: Menlo;"><br/><br>    BOOST_FOREACH(unique_future&lt;</span><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">int</span><span style="font-size: 14px; font-family: Menlo;">&gt;&amp; f,au){         :</span>      <span style="font-size: 14px; font-family: Menlo;">BOOST_FOREACH(unique_future&lt;</span><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">int</span><span style="font-size: 14px; font-family: Menlo;">&gt;&amp; f,au){</span><span style="font-size: 14px; font-family: Menlo;"><br/><br>        cout&lt;&lt;f.get()&lt;&lt;endl;                         :</span>      <span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">if</span><span style="font-size: 14px; font-family: Menlo;">(f.is_ready()&amp;&amp;f.has_value()) cout&lt;&lt;f.get()&lt;&lt;endl;</span><span style="font-size: 14px; font-family: Menlo;"><br/><br>    }                                                :<span style="-evernote-last-insertion-point:true;"/>   }<br/><br>    std::system(</span><span style="font-size: 14px; font-family: Menlo; color: rgb(209, 47, 27);">&quot;pause&quot;</span><span style="font-size: 14px; font-family: Menlo;">);<br/></span><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">return</span> <span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">0</span><span style="font-size: 14px; font-family: Menlo;">;<br/></span><br><div><span style="font-family: Menlo; font-size: 14px;">}</span><span style="font-size: 14px; font-family: Menlo;"><br/></span></div><br></BODY><br></HTML>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-04-14T13:30:27.000Z"><a href="/2014/04/14/网络库/">4月 14 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/04/14/网络库/">网络库</a></h1>
  

    </header>
    <div class="entry">
      
        <p><style type="text/css" id="wiz_custom_css"><br>body<br>{<br>    font-family: “Microsoft YaHei UI”,”Microsoft YaHei”,SimSun,”Segoe UI”,Tahoma,Helvetica,Sans-Serif,”Microsoft YaHei”, Georgia,Helvetica,Arial,sans-serif,宋体, PMingLiU,serif;<br>    font-size: 10.5pt;<br>    line-height: 1.5;<br>}<br>html, body<br>{</p>
<p>}<br>h1 {<br>    font-size:1.5em;<br>    font-weight:bold;<br>}<br>h2 {<br>    font-size:1.4em;<br>    font-weight:bold;<br>}<br>h3 {<br>    font-size:1.3em;<br>    font-weight:bold;<br>}<br>h4 {<br>    font-size:1.2em;<br>    font-weight:bold;<br>}<br>h5 {<br>    font-size:1.1em;<br>    font-weight:bold;<br>}<br>h6 {<br>    font-size:1.0em;<br>    font-weight:bold;<br>}<br>img {<br>    border:0;<br>    max-width: 100%;<br>}<br>blockquote {<br>    margin-top:0px;<br>    margin-bottom:0px;<br>}<br>table {<br>    border-collapse:collapse;<br>    border:1px solid #bbbbbb;<br>}<br>td {<br>    border-collapse:collapse;<br>    border:1px solid #bbbbbb;<br>}<br></style></p>
<HTML><HEAD><br><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=8" /><TITLE>网络库</TITLE><br><!--defaultCSS--><br><style type="text/css"><br>img{<br>    border:0px;<br>    max-width:90%;<br>}<br></style><br><BODY><br><font face="Menlo"><span style="font-size: 14px;">class address{<font color="#FF2703">&lt;boost/asio.hpp&gt; namespace boost::asio</font></span></font><br><div><span style="font-size: 14px;"><font face="Menlo"><font color="#FF2703">     </font>address(address&amp; addr);                                            //构造函数                          </font></span></div><br><div><span style="font-size: 14px;"><font face="Menlo">     address(char* p);</font></span></div><br><div><span style="font-size: 14px;"><font face="Menlo"><br/></font></span></div><br><div><span style="font-size: 14px;"><font face="Menlo">     bool is_v4();                                                      //是够v4地址</font></span></div><br><div><span style="font-size: 14px;"><font face="Menlo">     bool is_v6();</font></span></div><br><div><span style="font-size: 14px;"><font face="Menlo"><br/></font></span></div><br><div><span style="font-size: 14px;"><font face="Menlo">     address to_v4();                                                  </font></span></div><br><div><span style="font-size: 14px;"><font face="Menlo">     address to_v6();</font></span></div><br><div><span style="font-size: 14px;"><font face="Menlo"><br/></font></span></div><br><div><span style="font-size: 14px;"><font face="Menlo">     string to_string();                                                //字符串操作</font></span></div><br><div><span style="font-size: 14px;"><font face="Menlo">     address from_string(string&amp; str);</font></span></div><br><div><font face="Menlo"><span style="font-size: 14px;">}</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">class endpoint{</span></font><span style="color: rgb(255, 39, 3); font-family: Menlo; font-size: 14px;">&lt;boost/asio.hpp&gt; namespace boost:asio::ip::tcp</span></div><br><div><font face="Menlo"><span style="font-size: 14px;">     endpoint(address addr,int port);</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     </span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     address address();</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     int port();     </span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">}</span></font><br><hr/><br><font face="Menlo"><span style="font-size: 14px;">tcp编程模型(同步<span style="-evernote-last-insertion-point:true;"/>)：</span></font></div><br><div><font face="Menlo" color="#FF2600"><span style="font-size: 14px;">服务端：</span></font></div><br><div><font face="Menlo"><span style="font-size: 14px;">     </span></font><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">io_service</span> <span style="font-size: 14px; font-family: Menlo;">io</span><span style="font-size: 14px; font-family: Menlo;">;                                                                 :声明一个io设备类似于文件描述符</span></div><br><div><font face="Menlo"><span style="font-size: 14px;">     </span></font><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">ip</span><span style="font-size: 14px; font-family: Menlo;">::</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">tcp</span><span style="font-size: 14px; font-family: Menlo;">::</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">acceptor</span> <span style="font-size: 14px; font-family: Menlo;">acc(io,</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">ip</span><span style="font-size: 14px; font-family: Menlo;">::</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">tcp</span><span style="font-size: 14px; font-family: Menlo;">::</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">endpoint</span><span style="font-size: 14px; font-family: Menlo;">(</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">ip</span><span style="font-size: 14px; font-family: Menlo;">::</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">tcp</span><span style="font-size: 14px; font-family: Menlo;">::</span><span style="font-size: 14px; font-family: Menlo; color: rgb(61, 29, 129);">v4</span><span style="font-size: 14px; font-family: Menlo;">(),</span><span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">6688</span><span style="font-size: 14px; font-family: Menlo;">));               :声明tcp中的accept对象</span></div><br><div><span style="font-size: 14px; font-family: Menlo;">     </span><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">while</span><span style="font-size: 14px; font-family: Menlo;">(</span><span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">1</span><span style="font-size: 14px; font-family: Menlo;">){</span></div><br><span style="font-size: 14px; font-family: Menlo;">       </span> <span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">ip</span><span style="font-size: 14px; font-family: Menlo;">::</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">tcp</span><span style="font-size: 14px; font-family: Menlo;">::</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">socket</span> <span style="font-size: 14px; font-family: Menlo;">sock(io);                                                   :声明socket对象     <br/><br>        acc.</span><span style="font-size: 14px; font-family: Menlo; color: rgb(61, 29, 129);">accept</span><span style="font-size: 14px; font-family: Menlo;">(sock);                                                           :阻塞等待socket连接</span><span style="font-size: 14px; font-family: Menlo;"><br/><br>        sock.</span><span style="font-size: 14px; font-family: Menlo; color: rgb(61, 29, 129);">write_some</span><span style="font-size: 14px; font-family: Menlo;">(</span><span style="font-size: 14px; font-family: Menlo; color: rgb(61, 29, 129);">buffer</span><span style="font-size: 14px; font-family: Menlo;">(</span><span style="font-size: 14px; font-family: Menlo; color: rgb(209, 47, 27);">&quot;hello asio!&quot;</span><span style="font-size: 14px; font-family: Menlo;">));                                     :发送数据<br/><br>    }<br/></span><br><div><span style="color: rgb(255, 38, 0); font-family: Menlo; font-size: 14px;">客户端：</span><font face="Menlo"><span style="font-size: 14px;"><br/></span></font><br><div><font face="Menlo"><span style="font-size: 14px;">     </span></font><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">io_service</span> <span style="font-size: 14px; font-family: Menlo;">io;</span></div><br><span style="font-size: 14px; font-family: Menlo;">     </span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">ip</span><span style="font-size: 14px; font-family: Menlo;">::</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">tcp</span><span style="font-size: 14px; font-family: Menlo;">::</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">socket</span> <span style="font-size: 14px; font-family: Menlo;">sock(io);               <br/><br>     sock.</span><span style="font-size: 14px; font-family: Menlo; color: rgb(61, 29, 129);">connect</span><span style="font-size: 14px; font-family: Menlo;">(</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">ip</span><span style="font-size: 14px; font-family: Menlo;">::</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">tcp</span><span style="font-size: 14px; font-family: Menlo;">::</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">endpoint</span><span style="font-size: 14px; font-family: Menlo;">(</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">ip</span><span style="font-size: 14px; font-family: Menlo;">::</span><span style="font-size: 14px; font-family: Menlo; color: rgb(112, 61, 170);">address</span><span style="font-size: 14px; font-family: Menlo;">::</span><span style="font-size: 14px; font-family: Menlo; color: rgb(61, 29, 129);">from_string</span><span style="font-size: 14px; font-family: Menlo;">(</span><span style="font-size: 14px; font-family: Menlo; color: rgb(209, 47, 27);">&quot;127.0.0.1&quot;</span><span style="font-size: 14px; font-family: Menlo;">),</span><span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">6688</span><span style="font-size: 14px; font-family: Menlo;">));   :socket连接到端点<br/><br>     </span><span style="font-size: 14px; font-family: Menlo; color: rgb(187, 44, 162);">char</span> <span style="font-size: 14px; font-family: Menlo;">a[</span><span style="font-size: 14px; font-family: Menlo; color: rgb(39, 42, 216);">10000</span><span style="font-size: 14px; font-family: Menlo;">];<br/><br>     sock.</span><span style="font-size: 14px; font-family: Menlo; color: rgb(61, 29, 129);">receive</span><span style="font-size: 14px; font-family: Menlo;">(</span><span style="font-size: 14px; font-family: Menlo; color: rgb(61, 29, 129);">buffer</span><span style="font-size: 14px; font-family: Menlo;">(a));                                                       :接受数据<br/></span></div><br><div><span style="font-size: 14px; font-family: Menlo;"><br/></span></div><br></BODY><br></HTML>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-04-14T13:30:27.000Z"><a href="/2014/04/14/MPI/">4月 14 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/04/14/MPI/">MPI</a></h1>
  

    </header>
    <div class="entry">
      
        <p><style type="text/css" id="wiz_custom_css"><br>body<br>{<br>    font-family: “Microsoft YaHei UI”,”Microsoft YaHei”,SimSun,”Segoe UI”,Tahoma,Helvetica,Sans-Serif,”Microsoft YaHei”, Georgia,Helvetica,Arial,sans-serif,宋体, PMingLiU,serif;<br>    font-size: 10.5pt;<br>    line-height: 1.5;<br>}<br>html, body<br>{</p>
<p>}<br>h1 {<br>    font-size:1.5em;<br>    font-weight:bold;<br>}<br>h2 {<br>    font-size:1.4em;<br>    font-weight:bold;<br>}<br>h3 {<br>    font-size:1.3em;<br>    font-weight:bold;<br>}<br>h4 {<br>    font-size:1.2em;<br>    font-weight:bold;<br>}<br>h5 {<br>    font-size:1.1em;<br>    font-weight:bold;<br>}<br>h6 {<br>    font-size:1.0em;<br>    font-weight:bold;<br>}<br>img {<br>    border:0;<br>    max-width: 100%;<br>}<br>blockquote {<br>    margin-top:0px;<br>    margin-bottom:0px;<br>}<br>table {<br>    border-collapse:collapse;<br>    border:1px solid #bbbbbb;<br>}<br>td {<br>    border-collapse:collapse;<br>    border:1px solid #bbbbbb;<br>}<br></style></p>
<HTML><HEAD><br><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=8" /><TITLE>MPI</TITLE><br><!--defaultCSS--><br><style type="text/css"><br>img{<br>    border:0px;<br>    max-width:90%;<br>}<br></style><br><BODY><br><pre style="padding: 5px 10px 5px 3px !important; border: 1px solid rgb(204, 204, 204); outline: 0px; font-size: 11px; vertical-align: baseline; font-family: 'Andale Mono', 'Lucida Console', Monaco, Liberation, fixed, monospace; overflow: auto; clear: right; background-color: rgb(247, 247, 247) !important;"><br>#include &lt;boost/mpi.hpp&gt;<br>#include &lt;iostream&gt;<br>int main(int argc, char<em> argv[])<br>{<br>  boost::mpi::environment env(argc, argv);                              //初始化环境<br>  boost::mpi::communicator world;<br>  std::cout &lt;&lt; argc &lt;&lt; std::endl;<br>  std::cout &lt;&lt; argv[0] &lt;&lt; std::endl;<br>  std::cout &lt;&lt; &quot;Hello World! from process &quot; &lt;&lt; world.rank() &lt;&lt; std::endl;<br>}<br></pre><br><pre style="padding: 5px 10px 5px 3px !important; border: 1px solid rgb(204, 204, 204); outline: 0px; font-size: 11px; vertical-align: baseline; font-family: 'Andale Mono', 'Lucida Console', Monaco, Liberation, fixed, monospace; overflow: auto; clear: right; background-color: rgb(247, 247, 247) !important;"><br>#include &lt;boost/mpi.hpp&gt;<br>#include &lt;iostream&gt;<br>int main(int argc, char</em> argv[])<br>{<br>  boost::mpi::environment env(argc, argv);<br>  boost::mpi::communicator world;                                      //消息的传递<span style="-evernote-last-insertion-point:true;"/><br>  if (world.rank() == 0) {<br>    world.send(1, 9, 32);<br>    world.send(2, 9, 33);<br>  } else {<br>    int data;<br>    world.recv(0, 9, data);<br>    std::cout &lt;&lt; &quot;In process &quot; &lt;&lt; world.rank( ) &lt;&lt; &quot;with data &quot; &lt;&lt; data<br>                   &lt;&lt; std::endl;<br>  }<br>}<br></pre><br></BODY><br></HTML>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>






<nav id="pagination">
  
    <a href="/page/7/" class="alignleft prev">上一页</a>
  
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/C++11/">C++11</a><small>14</small></li>
  
    <li><a href="/categories/HTML/">HTML</a><small>14</small></li>
  
    <li><a href="/categories/SQL/">SQL</a><small>11</small></li>
  
    <li><a href="/categories/boost/">boost</a><small>9</small></li>
  
    <li><a href="/categories/python/">python</a><small>1</small></li>
  
    <li><a href="/categories/shell/">shell</a><small>12</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/C++11/">C++11</a><small>14</small></li>
  
    <li><a href="/tags/HTML/">HTML</a><small>14</small></li>
  
    <li><a href="/tags/SQL/">SQL</a><small>11</small></li>
  
    <li><a href="/tags/boost/">boost</a><small>9</small></li>
  
    <li><a href="/tags/python/">python</a><small>1</small></li>
  
    <li><a href="/tags/shell/">shell</a><small>12</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2014 Qiang Wei
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>